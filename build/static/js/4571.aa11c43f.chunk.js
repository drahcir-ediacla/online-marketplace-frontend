"use strict";(self.webpackChunkyogeek=self.webpackChunkyogeek||[]).push([[4571],{932:(e,a,l)=>{l.r(a),l.d(a,{default:()=>k});var i=l(2791),s=l(7689),t=l(2892),n=l(9434),o=l(2213),c=l(3548),d=(l(9655),l(6593)),r=l(960),u=l(1757),h=l(7057),p=l(9561),m=l(3535),g=l(5805),v=l(46),x=l(7148),j=l(314),b=l(3615),y=l(1424),f=l(7497),N=l(184);const k=()=>{const e=(0,n.I0)(),{id:a,product_name:l}=(0,s.UO)(),[k,w]=(0,i.useState)(null),[C,_]=(0,i.useState)(0),[U,I]=(0,i.useState)(!1),[D,L]=(0,i.useState)(""),[E,S]=(0,i.useState)(""),[Z,O]=(0,i.useState)([]),P=(0,i.useRef)(null),[B,R]=(0,i.useState)([]),[F,T]=(0,i.useState)(""),[Y,M]=(0,i.useState)({product_name:"",description:"",price:0,category_id:"",product_condition:"",mailing_delivery:null,youtube_link:""});console.log("mailing_delivery:",Y.mailing_delivery);const[V,A]=(0,i.useState)(null),z=e=>{_(e)},W=e=>{const a=e.target.value;T(a),M({...Y,product_condition:a})},G=e=>{const a=e.target.value,l=B.includes(a);R(l?e=>e.filter((e=>e!==a)):e=>[...e,a])};(0,i.useEffect)((()=>{M({...Y,mailing_delivery:B.length>0?B.join(" | "):null})}),[B]);const H=(e=>{let a=null;for(const l of Z){if(l.id===e){a=l.label;break}for(const i of l.subcategories){if(i.id===e){a=i.label;break}for(const l of i.subcategories)if(l.id===e){a=l.label;break}if(a)break}if(a)break}return a})(Y.category_id);(0,i.useEffect)((()=>{if(H){J(H,Z)&&L(H)}}),[H,Z]);const J=(e,a)=>{for(const l of a){if(l.label===e)return l;const a=J(e,l.subcategories);if(a)return a}return null},Q=e=>{let a=null;for(const l of Z){if(l.label===e){a=l;break}for(const i of l.subcategories){if(i.label===e){a=i;break}for(const l of i.subcategories)if(l.label===e){a=l;break}if(a)break}if(a)break}a&&(L(e),M({...Y,category_id:a.id})),I(!1)};(0,i.useEffect)((()=>{(async()=>{try{const e=await(0,o._X)();O(e.data)}catch(V){console.error("Error fetching data:",V)}})()}),[]),(0,i.useEffect)((()=>{a&&(w(a),(async()=>{try{var e;const i=(await(0,o.QB)(a,l)).data,s=i.mailing_delivery?i.mailing_delivery.split(" | "):[];M(i),T(i.product_condition),R(s);const t=(await(0,c.Md)()).data.user,n=i.meetup.map((e=>({placeId:e.placeId,name:e.name,address:e.address,latitude:e.latitude,longitude:e.longitude})));q(n);const d=i.images.map((e=>e.image_url)),r=i.videos.map((e=>e.video_url));ae(d),$(d),te(r),ie(r),(null===t||void 0===t?void 0:t.id)!==(null===i||void 0===i||null===(e=i.seller)||void 0===e?void 0:e.id)?A("You don't have permission to access this page."):A(null)}catch(V){console.error("Error fetching product details:",V),A("Error fetching product details. Please try again later.")}})())}),[a,l]),(0,i.useEffect)((()=>{const e=e=>{P.current&&!P.current.contains(e.target)&&(I(!1),O((e=>e.map((e=>({...e,isOpen:!1}))))))};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[]);const[X,q]=(0,i.useState)([]),[K,$]=(0,i.useState)([]),[ee,ae]=(0,i.useState)([]),[le,ie]=(0,i.useState)([]),[se,te]=(0,i.useState)([]),ne=async(a,l)=>{const i=[],s=new FormData;s.append("upload_preset","auwcvbw0"),s.append("cloud_name","yogeek-cloudinary"),s.append("folder","image"===l?"product_images":"product_videos");for(let t=0;t<a.length;t++){s.append("file",a[t]);try{e((0,u.P)(!0));const a=await fetch("https://api.cloudinary.com/v1_1/yogeek-cloudinary/".concat(l,"/upload"),{method:"POST",body:s});if(a.ok){const e=(await a.json()).secure_url;i.push(e)}else console.error("Error uploading ".concat(l," to Cloudinary:"),a.statusText)}catch(V){console.error("Error uploading ".concat(l," to Cloudinary:"),V.message)}finally{console.log("File ".concat(t+1," processed"))}}return console.log("Final fileUrls array for ".concat(l,":"),i),Y.fileUrls=i,console.log("productDetails.fileUrls:",Y.fileUrls),i};return V?(0,N.jsx)("div",{children:V}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.Z,{}),(0,N.jsx)("div",{className:"add-listing-body",children:(0,N.jsxs)("form",{className:"container",children:[(0,N.jsx)("h3",{children:"What are you listing today?"}),(0,N.jsxs)("div",{className:"box",children:[(0,N.jsx)("div",{className:"col-left",children:(0,N.jsxs)("div",{className:"add-media-container",children:[(0,N.jsxs)("div",{className:"add-image-box",children:[(0,N.jsx)("div",{className:"addlisting-upload-img",children:(0,N.jsx)(p.r,{})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{htmlFor:"imgUpload",className:"custom-file-upload",children:(0,N.jsx)(b.Z,{type:"button",label:"Add Image",className:"add-img-btn",onClick:()=>{document.getElementById("imgUpload").click()}})}),(0,N.jsx)("input",{type:"file",id:"imgUpload",multiple:!0,accept:"image/*",onChange:e=>{const a=e.target.files,l=Array.from(a);if(l.length+K.length>10)return void alert("You can only select up to ".concat(10," images."));const i=[];l.forEach((e=>{if(!e.type.startsWith("image/"))return void alert("Only image files are allowed.");if(e.size>2097152)return void alert("Selected images exceed the maximum file size of 2 MB.");const a=new FileReader;a.onload=e=>{i.push(e.target.result),i.length===l.length&&(ae((e=>[...e,...i])),$((e=>[...e,...l])))},a.readAsDataURL(e)}))},style:{display:"none"}}),(0,N.jsx)("div",{children:"(Maximum of 10 photos)"})]})]}),(0,N.jsx)("div",{className:"upload-img-preview-container",children:ee.map(((e,a)=>(0,N.jsxs)("div",{className:"upload-img-box",children:[(0,N.jsx)("img",{src:e,alt:"Img ".concat(a),className:"upload-img-preview"}),(0,N.jsx)("div",{onClick:()=>(e=>{const a=ee.filter(((a,l)=>l!==e)),l=K.filter(((a,l)=>l!==e));ae(a),$(l)})(a),className:"upload-img-close"})]},a)))}),(0,N.jsxs)("div",{className:"add-video-container",children:[(0,N.jsx)("span",{className:"title-video",children:"Video"}),(0,N.jsxs)("div",{className:"upload-vid-options",children:[(0,N.jsx)("div",{children:(0,N.jsxs)("label",{htmlFor:"uploadvidID",className:"radio-container",children:["Upload Video",(0,N.jsx)("input",{type:"radio",id:"uploadvidID",checked:0===C,className:"".concat(0===C?"active":""),onClick:()=>z(0)}),(0,N.jsx)("span",{className:"checkmark"})]})}),(0,N.jsx)("div",{children:(0,N.jsxs)("label",{htmlFor:"youtubelinkID",className:"radio-container",children:["Youtube Link",(0,N.jsx)("input",{type:"radio",id:"youtubelinkID",checked:1===C,className:"".concat(1===C?"active":""),onClick:()=>z(1)}),(0,N.jsx)("span",{className:"checkmark"})]})})]}),(0,N.jsx)("div",{style:{display:0===C?"block":"none"},children:(0,N.jsxs)("div",{className:"upload-video-content",children:[se.length>0?(0,N.jsxs)("div",{className:"video-preview-container",children:[(0,N.jsxs)("video",{width:"498",height:"280",controls:!0,children:[(0,N.jsx)("source",{src:se[0],type:"video/mp4"}),"Your browser does not support the video tag."]}),(0,N.jsx)("div",{className:"remove-video-preview",onClick:()=>{te([]),ie([])}})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("label",{htmlFor:"videoUpload",children:(0,N.jsxs)("button",{type:"button",className:"upload-video-box",onClick:()=>{document.getElementById("videoUpload").click()},children:[(0,N.jsx)("div",{className:"addlisting-upload-vid",children:(0,N.jsx)(m.r,{})}),(0,N.jsx)("span",{children:"Add Video"})]})}),(0,N.jsx)("div",{children:(0,N.jsxs)("ul",{children:[(0,N.jsx)("li",{children:"Min size: 480x480 px. max video length: 60 seconds. max file size: 100MB."}),(0,N.jsx)("li",{children:"Supported Format: mp4"}),(0,N.jsx)("li",{children:"New Video might take up to 36 hrs to be approved"})]})})]}),(0,N.jsx)("input",{type:"file",id:"videoUpload",accept:"video/*",style:{display:"none"},onChange:e=>{const a=e.target.files;if(a.length>1)return void alert("You can only select up to ".concat(1," video."));const l=a[0];if(!l.type.startsWith("video/"))return void alert("Only video files are allowed.");if(l.size>52428800)return void alert("The selected video exceeds the maximum file size of 50 MB.");const i=new FileReader;i.onload=e=>{te([e.target.result]),ie([l])},i.readAsDataURL(l)}})]})}),(0,N.jsxs)("div",{style:{display:1===C?"block":"none"},children:[(0,N.jsx)(g.Z,{name:"youtube_link",value:Y.youtube_link,placeholder:"Paste your Youtube URL link here",className:"input-youtube-link",onChange:e=>M({...Y,youtube_link:e.target.value})}),(0,N.jsx)("h6",{className:"embed-youtube-instructions",children:"Please follow instructions on how to embed youtube video."}),(0,N.jsx)("b",{children:"1. Get the Youtube Link:"}),(0,N.jsxs)("p",{children:["Get the YouTube video ID from the video URL. For example, in the URL ",(0,N.jsx)("span",{className:"youtube-link",children:"https://www.youtube.com/watch?v=VIDEO_ID"}),", ",(0,N.jsx)("span",{className:"video-id",children:'"VIDEO_ID"'})," is the actual video ID."]}),(0,N.jsx)("b",{children:"2. Create Youtube Embed URL:"}),(0,N.jsx)("p",{children:"Use the YouTube video ID to create the YouTube embed URL. See sample URL below."}),(0,N.jsx)("span",{className:"sample-embed-url-label",children:"Sample Youtube Embed URL:"}),(0,N.jsx)("p",{className:"sample-embed-url",children:"https://youtube.com/embed/VIDEO_ID"})]})]})]})}),(0,N.jsx)("div",{className:"col-right",children:(0,N.jsxs)("div",{className:"select-category-container",children:[(0,N.jsxs)("div",{className:"wrapper",ref:P,children:[(0,N.jsx)("div",{className:"select-arrow ".concat(U?"active":""),onClick:()=>{I(!U)}}),(0,N.jsx)("div",{className:"dropdown-category",children:(0,N.jsx)("input",{type:"text",id:"selectCategory",value:D,placeholder:"Select Category",readOnly:!0})}),U&&(0,N.jsx)("div",{className:"category-option-list",children:(0,N.jsxs)("ul",{children:[(0,N.jsx)("li",{children:(0,N.jsxs)("div",{className:"search-container",children:[(0,N.jsx)("input",{type:"text",placeholder:"Search Categories",value:E,onChange:e=>{S(e.target.value)}}),(0,N.jsx)("div",{className:"magnifying-glass",children:(0,N.jsx)(h.r,{})})]})}),Z.map((e=>e.label.toLowerCase().includes(E.toLowerCase())?(0,N.jsxs)("li",{className:"main-category",children:[(0,N.jsxs)("div",{className:"parent-category ".concat(e.subcategories.length>0?"collapsible":""," ").concat(e.isOpen&&e.subcategories.length>0?"active":""),onClick:()=>{var a;0===e.subcategories.length?Q(e.label):(a=e,O((e=>e.map((e=>e===a?{...e,isOpen:!e.isOpen}:{...e,isOpen:!1})))))},children:[(0,N.jsx)("img",{src:e.icon,alt:""}),e.label]}),e.isOpen&&e.subcategories&&e.subcategories.length>0?(0,N.jsx)("ul",{className:"sub-category",children:e.subcategories.map((a=>(0,N.jsxs)("li",{children:[(0,N.jsx)("div",{className:"first-level-sub-category ".concat(a.subcategories.length>0?"collapsible":""," ").concat(a.isOpen&&a.subcategories.length>0?"active":""),onClick:()=>{0===a.subcategories.length?Q(a.label):((e,a)=>{a.subcategories=a.subcategories.map((a=>a===e?{...a,isOpen:!a.isOpen}:{...a,isOpen:!1})),O([...Z])})(a,e)},children:a.label}),a.isOpen&&a.subcategories&&a.subcategories.length>0?(0,N.jsx)("ul",{className:"sub-sub-category",children:a.subcategories.map((e=>(0,N.jsx)("li",{children:(0,N.jsx)("div",{className:"second-level-sub-category",onClick:()=>Q(e.label),children:e.label})},e.value)))}):null]},a.value)))}):null]},e.value):null))]})})]}),"Nike"===D&&(0,N.jsx)("div",{children:(0,N.jsx)("h3",{children:"Nike"})}),"Adidas"===D&&(0,N.jsx)("div",{children:(0,N.jsx)("h3",{children:"Adidas"})}),"New Balance"===D&&(0,N.jsx)("div",{children:(0,N.jsx)("h3",{children:"New Balance"})}),D&&"Nike"!==D&&"Adidas"!==D&&"New Balance"!==D&&(0,N.jsxs)("div",{className:"add-prod-details-form",children:[(0,N.jsx)("input",{type:"hidden",name:"category_id",value:Y.category_id,onChange:e=>M({...Y,category_id:e.target.value})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"Title"}),(0,N.jsx)(g.Z,{type:"text",id:"listingTitleID",name:"product_name",value:Y.product_name,className:"listing-input-field",placeholder:"Listing Title",onChange:e=>M({...Y,product_name:e.target.value})})]}),(0,N.jsx)("h3",{children:"About the item"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"Condition"}),(0,N.jsxs)("div",{className:"product-conditions",children:[(0,N.jsx)(v.Z,{id:"brandNewID",name:"product_condition",value:"Brand New",label:"Brand New",checked:"Brand New"===F,onChange:W}),(0,N.jsx)(v.Z,{id:"likeNewID",name:"product_condition",value:"Like New",label:"Like New",checked:"Like New"===F,onChange:W}),(0,N.jsx)(v.Z,{id:"lightlyUsedID",name:"product_condition",value:"Lightly Used",label:"Lightly Used",checked:"Lightly Used"===F,onChange:W}),(0,N.jsx)(v.Z,{id:"wellUsedID",name:"product_condition",value:"Well Used",label:"Well Used",checked:"Well Used"===F,onChange:W}),(0,N.jsx)(v.Z,{id:"heavilyUsedID",name:"product_condition",value:"Heavily Used",label:"Heavily Used",checked:"Heavily Used"===F,onChange:W})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"Price"}),(0,N.jsxs)("div",{className:"listing-price-container",children:[(0,N.jsx)("div",{className:"listing-currency",children:"\u20b1"}),(0,N.jsx)(g.Z,{type:"number",id:"listingPriceID",name:"price",value:Y.price,className:"listing-price-input-field",placeholder:"Price of your listing",onChange:e=>M({...Y,price:e.target.value})})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"Description"}),(0,N.jsx)("div",{children:(0,N.jsx)(f.Z,{id:"listingDescID",name:"description",className:"listing-description",value:Y.description,onChange:e=>{M({...Y,description:e})}})})]}),(0,N.jsx)("h3",{children:"Deal Method"}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"Meet Up"}),(0,N.jsx)(y.Z,{onSelectedPlacesChange:e=>{q(e)},fetchedMeetupPlaces:X})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{children:"Mailing & Delivery"}),(0,N.jsxs)("div",{className:"delivery-options",children:[(0,N.jsxs)("div",{className:"delivery-options-col1",children:[(0,N.jsx)(x.Z,{label:"Lalamove",value:"Lalamove",onChange:G,checked:B.includes("Lalamove")}),(0,N.jsx)(x.Z,{label:"Grab Express",value:"Grab Express",onChange:G,checked:B.includes("Grab Express")}),(0,N.jsx)(x.Z,{label:"Ninja Van",value:"Ninja Van",onChange:G,checked:B.includes("Ninja Van")})]}),(0,N.jsxs)("div",{className:"delivery-options-col2",children:[(0,N.jsx)(x.Z,{label:"LBC",value:"LBC",onChange:G,checked:B.includes("LBC")}),(0,N.jsx)(x.Z,{label:"J&T",value:"J&T",onChange:G,checked:B.includes("J&T")})]})]})]}),(0,N.jsxs)("div",{className:"update-listing-btns",children:[(0,N.jsx)(j.Z,{label:"Update Listing",className:"list-now-btn",onClick:async i=>{if(i.preventDefault(),!Y.product_name)return void alert("Please enter a title for your listing.");if(Y.product_name.length<5)return void alert("Title must be at least 5 characters long.");if(!Y.price||isNaN(Y.price)||Y.price<=0)return void alert("Please enter a valid price for your listing.");if(0===ee.length)return void alert("Please upload at least one image for your listing.");const s=await ne(K,"image"),n=await ne(le,"video"),o={...Y,fileUrls:[...s,...n],meetupLocations:X.map((e=>({placeId:e.placeId,name:e.name,address:e.address,latitude:e.latitude,longitude:e.longitude})))};t.Z.put("/api/updateproductbyid/".concat(a,"/").concat(encodeURIComponent(l)),o).then((a=>{var l,i;e((0,u.P)(!0)),console.log("Product added successfully:",a.data);const s=null===(l=a.data.product)||void 0===l?void 0:l.id,t=null===(i=a.data.product)||void 0===i?void 0:i.product_name;console.log("productId:",s),console.log("productName:",t),window.location.href="/productdetails/".concat(s,"/").concat(encodeURIComponent(t)),e((0,u.P)(!1))})).catch((a=>{e((0,u.P)(!1)),console.error("Error adding the product:",a)}))}}),(0,N.jsx)(b.Z,{type:"button",label:"Cancel",onClick:()=>{window.location.href="/productdetails/".concat(a,"/").concat(encodeURIComponent(l))}})]})]})]})})]})]})}),(0,N.jsx)(r.Z,{})]})}}}]);
//# sourceMappingURL=4571.aa11c43f.chunk.js.map